#!/usr/bin/env bb
;; =============================================================================
;; journal app from babook - clojure/babashka
;; =============================================================================

(require '[babashka.cli :as cli]
         '[journal.add  :as add]
         '[journal.list :as ls])

(def cli-opts
  {:entry     {:alias   :e
               :desc    "What you want to add to the journal."
               :require true}
   :timestamp {:alias   :t
               :desc    "A unix timestamp, when your recorded this."
               :coerce  {:timestamp :long}}})

(defn help
  [_]
  (println (str "add\n" (cli/format-opts {:spec cli-opts})))
  (println "list\n" "list entries.")
)

(def table
  [{:cmds ["add"] :fn #(add/add-entry (:opts %)) :spec cli-opts}
   {:cmds ["list"] :fn #(ls/list-entries %)}
   {:cmds [] :fn help}])

;; -----------------------------------------------------------------------------
(cli/dispatch table *command-line-args*)

; vim: set ft=clojure :
